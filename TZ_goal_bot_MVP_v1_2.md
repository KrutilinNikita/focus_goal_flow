
# ТЗ на доработку бота «Главная цель дня»
Версия: MVP 1.2

---

# 1. Цель доработки

Расширить бота так, чтобы пользователь мог:

1. Определять свои долгосрочные “хочу”
2. Привязывать ежедневные цели к “хочу”
3. Вести рефлексию по выполненным целям
4. Смотреть дневник прогресса

Продуктовая идея:
Бот помогает помнить о личных приоритетах и двигаться к ним маленькими шагами вне работы.

---

# 2. Онбординг и доступ к функции “Хочу”

Важно:

- при первом использовании бот не предлагает пользоваться “Хочу”
- основной сценарий — цели дня
- раздел “Хочу” описан в команде:

```
/wants
```

Пользователь сам принимает решение использовать эту механику.

---

# 3. Понятие “Хочу”

“Хочу” — это долгосрочное направление или цель пользователя, к которой относятся ежедневные цели.

## Возможные трактовки

### Вариант 1 — Хочу = направление

Примеры:
- Хочу улучшить здоровье  
- Хочу увеличить доход  
- Хочу выучить английский  
- Хочу наладить режим  

Это больше похоже на жизненные вектора.

---

### Вариант 2 — Хочу = проект

Примеры:
- Хочу запустить MVP  
- Хочу пробежать 10 км  
- Хочу собрать портфолио  

Это уже конкретные проекты.

---

### Вариант 3 — гибрид

Пользователь сам решает, что для него “хочу”.

---

# 4. Ограничения

Пользователь может иметь:
- максимум 2 активных “хочу”
- остальные могут быть:
  - inactive
  - archived

---

# 5. Интерфейс “Мои хочу”

При открытии:

Сначала показываются:
- активные хочу

Дополнительно:
- кнопка “Остальные”

Пути (группы) — вторичная сущность и не должны доминировать в интерфейсе.

---

# 6. Привязка цели к “Хочу”

При создании цели:

Бот предлагает:

```
К какому хочу относится цель?
```

Кнопки:
- список активных хочу
- Без категории

---

# 7. Рефлексия после выполнения

После нажатия:

```
Сделано ✅
```

Бот предлагает:

```
Хочешь записать мысли, опыт или результат?
```

Кнопки:
- Написать
- Пропустить

Текст:
- свободный формат
- сохраняется в базе

---

# 8. Дневник прогресса

Путь:

```
Мои хочу → выбрать хочу → История
```

Показывается список:

- Дата  
- Цель  
- Комментарий  

Сортировка:
- по дате

---

# 9. Пути (группы хочу)

Путь — это группа нескольких “хочу”.

Возможности:
- создать путь
- назвать путь
- добавить несколько “хочу”
- убрать “хочу” из пути

---

# 10. База данных (финальная структура)

## Таблица users

```
user_id
username
first_name
first_seen_at
```

---

## Таблица wishes

```
id
user_id
text
status (active / inactive / archived)
family_id (nullable)
created_at
archived_at
position
```

---

## Таблица wish_families

```
id
user_id
name
created_at
```

---

## Таблица goals

```
id
user_id
goal_date
goal_text
status
created_at
completed_at
locked_after_done
wish_id (nullable)
family_id_snapshot (nullable)
reflection_text (nullable)
```

---

# 11. Логика family_id_snapshot

Это поле:

- заполняется при создании цели
- используется для аналитики и истории
- не используется как источник истины в приложении

Источник истины:

```
wishes.family_id
```

---

# 12. SQL логика дневника

По хочу:

```
WHERE wish_id = X
```

По пути:

```
JOIN wishes
WHERE wishes.family_id = X
```

---

# 13. Логи

Дополнительно логировать:

- создание хочу
- создание пути
- добавление хочу в путь
- добавление рефлексии

---

# 14. Порядок реализации

1. Таблица wishes
2. Привязка goals → wish_id
3. Рефлексия
4. Дневник
5. Пути

---

# 15. Ограничения MVP

Не делать пока:
- графики прогресса
- сложную аналитику
- напоминания по хочу

---

# 16. Архитектурный принцип

Главное в продукте:

Цель → Хочу → Путь

Не наоборот.

Цель — главный объект системы.
